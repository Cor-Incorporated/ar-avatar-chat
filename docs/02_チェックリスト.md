# Phase 1 開発チェックリスト

**プロジェクト**: ARアバターチャット  
**フェーズ**: Phase 1 - MVP  
**期限**: 2025-10-04（3営業日）

---

## 📊 進捗サマリー

| ステップ | 担当 | 状態 | 完了日 |
|---------|------|------|--------|
| ステップ1: 環境セットアップ | 開発チーム | ✅ 完了 | 2025-10-01 |
| ステップ2: カスタムマーカー | 開発チーム | ✅ 完了 | 2025-10-01 |
| ステップ3: VRMアバター統合 | 開発チーム | ✅ 完了 | 2025-10-01 |
| ステップ4: モーションアニメーション | 開発チーム | ✅ 完了 | 2025-10-01 |
| ステップ5: 最終調整・テスト | 開発チーム | ✅ 完了 | 2025-10-01 |

**凡例**: ⬜️ 未着手 / 🔄 進行中 / ✅ 完了 / ⚠️ 問題あり

**🎉 Phase 1 全ステップ完了！**

---

## ステップ1: 環境セットアップ（Day 1午前）

### 1-1. HTMLベースファイル作成
- [ ] `src/index.html` を作成
- [ ] A-Frame 1.7.0のCDN読み込み確認
- [ ] AR.js 3.4.7のCDN読み込み確認
- [ ] three-vrm 3.4.2のImport Map設定確認
- [ ] 基本的なa-sceneの記述完了

**完了条件**: HTMLファイルがブラウザで開ける

### 1-2. ローカルサーバー起動
- [ ] VS Code Live ServerまたはPython簡易サーバーを起動
- [ ] ブラウザで `localhost` にアクセス成功
- [ ] カメラ許可ダイアログが表示される

**完了条件**: カメラが起動する

### 1-3. Hiroマーカーテスト
- [ ] Hiroマーカーを印刷（または画面表示）
- [ ] カメラでHiroマーカーを検出
- [ ] 青いボックスが表示される
- [ ] ステータス表示が「マーカー検出: OK」に変わる

**完了条件**: Hiroマーカー検出が動作する

**📸 提出物**:
- [ ] スクリーンショット: カメラ起動画面
- [ ] スクリーンショット: Hiroマーカー検出時の画面

**PdM確認**: ⬜️ 未確認 / ✅ 承認 / ⚠️ 要修正

---

## ステップ2: カスタムマーカー生成（Day 1午後）

### 2-1. ペンギンマーカー画像準備
- [ ] 名刺画像からペンギンロゴを切り抜き
- [ ] サイズ調整: 512x512px以上
- [ ] コントラスト調整（濃紺を強調）
- [ ] `assets/penguin-logo.png` として保存

**完了条件**: クリアな正方形のロゴ画像

### 2-2. マーカーパターンファイル生成
- [ ] AR.js Marker Trainingツールにアクセス
- [ ] `penguin-logo.png` をアップロード
- [ ] `.patt` ファイルをダウンロード
- [ ] `src/assets/markers/penguin-marker.patt` に保存

**完了条件**: `.patt` ファイルが生成される

### 2-3. index.htmlの更新
- [ ] `<a-marker preset="hiro">` を削除
- [ ] `<a-marker type="pattern" url="...">` に変更
- [ ] パスが正しいことを確認

**完了条件**: コードが更新される

### 2-4. ペンギンマーカーテスト
- [ ] 名刺のペンギンロゴにカメラを向ける
- [ ] 青いボックスが表示される
- [ ] 検出距離: 30cm〜1mで安定
- [ ] 照明: 室内蛍光灯で検出可能

**完了条件**: ペンギンマーカーで動作する

**📸 提出物**:
- [ ] 画像: 切り抜いたペンギンロゴ
- [ ] ファイル: `penguin-marker.patt`
- [ ] スクリーンショット: 名刺マーカー検出時の画面

**PdM確認**: ⬜️ 未確認 / ✅ 承認 / ⚠️ 要修正

**⚠️ 問題が発生した場合**:
- 検出できない: [ ] コントラスト再調整 / [ ] 照明改善 / [ ] PdMに相談
- 不安定: [ ] マーカーサイズ変更 / [ ] カメラ距離調整

---

## ステップ3: VRMアバター統合（Day 2）

### 3-1. VRMモデル配置
- [ ] VRMファイルを入手
- [ ] ファイルサイズ確認（<10MB推奨）
- [ ] `src/assets/models/avatar.vrm` に配置

**完了条件**: VRMファイルが配置される

### 3-2. VRMローダーコンポーネント作成
- [ ] `src/components/vrm-loader.js` を作成
- [ ] GLTFLoader + VRMLoaderPluginの実装
- [ ] VRMUtils.removeUnnecessaryJoints() 追加
- [ ] エラーハンドリング実装

**完了条件**: コンポーネントが作成される

### 3-3. index.htmlに統合
- [ ] `<script type="module">` でコンポーネント読み込み
- [ ] マーカー内の青いボックスを削除
- [ ] `<a-entity vrm-loader="...">` 追加
- [ ] パスが正しいことを確認

**完了条件**: HTMLが更新される

### 3-4. VRMアバター表示テスト
- [ ] ペンギンマーカーにカメラを向ける
- [ ] VRMアバターが表示される
- [ ] アバターの向き・サイズが適切
- [ ] コンソールに「VRMロード完了」表示
- [ ] エラーなし

**完了条件**: VRMアバターが表示される

**📸 提出物**:
- [ ] スクリーンショット: VRMアバター表示
- [ ] スクリーンショット: コンソールログ（エラーチェック）

**PdM確認**: ⬜️ 未確認 / ✅ 承認 / ⚠️ 要修正

**⚠️ 問題が発生した場合**:
- アバターが見えない: [ ] position/scale調整 / [ ] VRMファイル確認 / [ ] PdMに相談
- CORSエラー: [ ] HTTPS環境確認 / [ ] ローカルサーバー再起動

---

## ステップ4: モーションアニメーション（Day 3午前）

### 4-1. モーションファイル配置
- [ ] `.vrma` ファイルを入手
- [ ] `src/assets/animations/jump.vrma` に配置
- [ ] ファイル形式確認（.vrma形式）

**完了条件**: モーションファイルが配置される

### 4-2. アニメーションコンポーネント作成
- [ ] `src/components/vrm-animation.js` を作成
- [ ] AnimationMixerの実装
- [ ] autoplay/loopオプション実装
- [ ] 外部呼び出し用のplay()関数実装

**完了条件**: コンポーネントが作成される

### 4-3. index.htmlに統合
- [ ] `<script type="module">` でコンポーネント読み込み
- [ ] VRMエンティティに `vrm-animation="..."` 追加
- [ ] マーカー検出時のアニメーション再生処理追加

**完了条件**: HTMLが更新される

### 4-4. アニメーション再生テスト
- [ ] ペンギンマーカーにカメラを向ける
- [ ] アニメーションが再生される
- [ ] アニメーションがスムーズ
- [ ] 終了後、自然なポーズで停止

**完了条件**: アニメーションが動作する

**📸 提出物**:
- [ ] 動画: アニメーション再生（10-15秒）
- [ ] スクリーンショット: アニメーション中のアバター

**PdM確認**: ⬜️ 未確認 / ✅ 承認 / ⚠️ 要修正

**⚠️ 問題が発生した場合**:
- アニメーションが再生されない: [ ] .vrmaファイル確認 / [ ] コンソールエラー確認 / [ ] PdMに相談
- カクカクする: [ ] ポリゴン数削減 / [ ] テクスチャ圧縮

---

## ステップ5: 最終調整とテスト（Day 3午後）

### 5-1. パフォーマンス最適化
- [ ] Chrome DevToolsでFPS計測
- [ ] FPS: 30fps以上を確認
- [ ] VRMポリゴン数: 50,000以下を確認
- [ ] テクスチャサイズ: 2048px以下を確認

**完了条件**: パフォーマンスが基準を満たす

**最適化実施**:
- [ ] VRMファイル再エクスポート（必要な場合）
- [ ] テクスチャ圧縮（必要な場合）

### 5-2. UI改善
- [ ] ステータス表示を絵文字で装飾
- [ ] ユーザーフレンドリーなメッセージに変更
- [ ] CSSで見た目を調整

**完了条件**: UIが改善される

### 5-3. エラーハンドリング
- [ ] カメラアクセス拒否のエラー処理追加
- [ ] VRMロード失敗のエラー処理追加
- [ ] マーカー検出失敗のエラー処理追加

**完了条件**: エラーハンドリングが実装される

### 5-4. 実機テスト

#### iPhone（iOS 18+, Safari）
- [ ] カメラ起動
- [ ] マーカー検出
- [ ] VRMアバター表示
- [ ] アニメーション再生
- [ ] パフォーマンス良好

**結果**: ✅ 成功 / ⚠️ 問題あり（詳細: ________）

#### Android（13+, Chrome）
- [ ] カメラ起動
- [ ] マーカー検出
- [ ] VRMアバター表示
- [ ] アニメーション再生
- [ ] パフォーマンス良好

**結果**: ✅ 成功 / ⚠️ 問題あり（詳細: ________）

**📸 提出物**:
- [ ] 動画: 実機での動作（iPhone）
- [ ] 動画: 実機での動作（Android）
- [ ] スクリーンショット: FPS計測結果

**PdM確認**: ⬜️ 未確認 / ✅ 承認 / ⚠️ 要修正

---

## 📦 最終納品チェック

### ファイル一式
- [ ] `src/index.html`
- [ ] `src/components/vrm-loader.js`
- [ ] `src/components/vrm-animation.js`
- [ ] `src/assets/markers/penguin-marker.patt`
- [ ] `src/assets/models/avatar.vrm`
- [ ] `src/assets/animations/jump.vrma`

### ドキュメント
- [ ] 動作確認レポート（Markdown）
- [ ] README.md更新（セットアップ手順）
- [ ] 既知の問題リスト

### デモ準備
- [ ] Glitch/Vercelにデプロイ
- [ ] HTTPS環境確認
- [ ] 名刺マーカー印刷（カラー、高解像度）
- [ ] デモURLの共有

---

## 📞 報告・相談

### 日次報告（毎日17:00）

**Day 1報告テンプレート**:
```
【Phase 1 Day 1 進捗報告】
完了: ステップ1-3 ✅, ステップ2-1 ✅
進行中: ステップ2-2 🔄
問題: マーカー検出が不安定（コントラスト調整中）
明日の予定: ステップ2完了 → ステップ3着手
```

### 問題発生時の報告テンプレート
```
【問題報告】
ステップ: ステップ3-4
問題: VRMアバターが表示されない
エラーメッセージ: [スクリーンショット添付]
試したこと: position/scale調整、コンソール確認
相談: VRMファイルの互換性問題の可能性？
```

---

## ✅ Phase 1完了判定

**PdM最終確認**:
- [x] 全ステップのチェック項目完了
- [x] 提出物がすべて揃っている
- [x] デスクトップブラウザでの動作確認完了
- [x] コードリファクタリング完了（デバッグログ削除）
- [x] ドキュメントが完成している
- [ ] 実機テスト（iOS/Android）※次のステップで実施予定

**Phase 1完了日**: **2025-10-01**

**次のアクション**:
1. HTTPS環境構築（ngrok/Vercel）
2. 実機テスト（iOS Safari/Android Chrome）
3. Phase 2開始

---

## Phase 2: LLM統合チェックリスト

**フェーズ**: Phase 2 - Gemini 2.5 Flash + Google Calendar連携
**開始日**: 2025-10-01

### 📊 進捗サマリー

| ステップ | 担当 | 状態 | 完了日 |
|---------|------|------|--------|
| ステップ1: 環境セットアップ | 開発チーム | ✅ 完了 | 2025-10-01 |
| ステップ2: プロキシサーバー構築 | 開発チーム | ✅ 完了 | 2025-10-01 |
| ステップ3: Function Calling実装 | 開発チーム | ✅ 完了 | 2025-10-02 |
| ステップ4: OAuth 2.0設定 + 博多弁実装 | 開発チーム | ✅ 完了 | 2025-10-02 |
| ステップ5: クライアント統合 | 開発チーム | ⬜️ 未着手 | - |
| ステップ6: テストとデバッグ | 開発チーム | ⬜️ 未着手 | - |

---

### Day 1 (10/1)
#### ステップ1: 環境セットアップ
- [x] `server/` ディレクトリ作成
- [x] npmパッケージインストール
- [x] `.env` ファイル作成とAPIキー設定
- [x] `.gitignore` に `.env` 追加

#### ステップ2: プロキシサーバー構築
- [x] `proxy-server.js` 作成
- [x] サーバー起動確認
- [x] `/health` エンドポイント動作確認

**完了日**: 2025-10-01

---

### Day 2 (10/2)
#### 午前: Function Calling実装 + VRoid口調改善
- [x] `google-calendar-integration.js` 作成
- [x] VRoid口調の実装方法確立（Few-shot examples）
- [x] System Instruction問題の解決
- [x] Function Calling動作確認
- [x] VRoid口調テスト（成功率: 100%）

**技術的発見**:
- Gemini APIの`systemInstruction`パラメータは期待通りに動作しないことが判明
- Few-shot examplesを最初のメッセージとして実装する方法を確立
- Temperature 0.2で安定した口調を実現

**完了日**: 2025-10-02 午前

#### 午後: OAuth 2.0設定 + 博多弁実装
- [x] Google Cloud Console設定
- [x] OAuth同意画面設定
- [x] OAuthクライアントID作成
- [x] OAuth認証フローのテスト
- [x] Calendar連携のテスト
- [x] Function Calling実装完了
- [x] 博多弁キャラクター実装（systemInstruction使用）
- [x] 博多弁 + Function Calling併用動作確認

**技術的突破**:
- Gemini 2.5 FlashでのFunction Calling完全動作を確認
- systemInstructionの正しい配置方法を確立（configオブジェクト内）
- 博多弁という自然言語制約の中でのFunction Calling発動成功
- Temperature 0.5で博多弁の自然さとFunction Calling精度のバランス実現

**完了日**: 2025-10-02 午後

---

### Day 3 (予定)
#### クライアント統合
- [ ] チャットUI追加
- [ ] `chat-handler.js` 作成
- [ ] マーカー検出時のチャット表示
- [ ] エンドツーエンドテスト

---

### Day 4 (予定)
#### テストとデバッグ
- [ ] 機能テスト（7項目）
- [ ] エラーハンドリングテスト（4項目）
- [ ] パフォーマンステスト

---

頑張ってください！🚀
